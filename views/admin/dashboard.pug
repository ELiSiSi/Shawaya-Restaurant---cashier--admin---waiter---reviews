extends base

block content
  .dashboard-container
    h2 Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…

    // ===== Cards =====
    .dashboard-cards
      .card
        h3 Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        p #{orders.length} Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯

      .card
        h3 Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        p #{meals.length} Ù…Ù†ØªØ¬

      .card
        h3 Ø§Ù„Ø¹Ø±ÙˆØ¶
        p #{offers.length} Ø¹Ø±Ø¶

      .card
        h3 Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª
        - let Total=0
        each orderDone in ordersDone
          - Total+=orderDone.total
        p #{Total} Ø¬Ù†ÙŠÙ‡

    // ===== Latest Orders =====
    .dashboard-section
      .section-header
        h3 ğŸ§¾ Ø¢Ø®Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        if orders && orders.length > 0
          button.btn-delete.btn-delete-all(onclick="deleteAllOrders()") ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª

      table.orders-table
        thead
          tr
            th Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨
            th Ø§Ù„Ø§Ø³Ù…
            th Ø§Ù„Ù‡Ø§ØªÙ
            th Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
            th Ø§Ù„Ù…Ø¨Ù„Øº
            th Ø§Ù„Ø­Ø§Ù„Ø©
            th Ø§Ù„Ø¯ÙØ¹
            th Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
        tbody
          if orders && orders.length > 0
            - var limitedOrders = orders.slice(0, 5)
            each order, index in limitedOrders
              tr
                td #{index + 1}
                td #{order.name}
                td #{order.number}
                td #{order.address}
                td #{order.total} Ø¬Ù†ÙŠÙ‡
                td
                  span.status(class=order.status) #{order.status || 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°'}
                td #{order.paying}
                td.actions-cell
                  button.btn-small(onclick=`showOrderInvoice('${order._id}')`) Ø¹Ø±Ø¶
                  button.btn-delete.btn-delete-order(onclick=`deleteOrder('${order._id}')`) Ø­Ø°Ù
          else
            tr
              td(colspan="7").no-data Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹

    // Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø²ÙŠ Ù…Ø§ Ù‡Ùˆ...
    // ===== Products Section =====
    .dashboard-section
      .section-header
        h3 ğŸ½ï¸ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        button.btn-primary(onclick="openAddMealModal()") + Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯

      table.products-table
        thead
          tr
            th Ø§Ù„ØµÙˆØ±Ø©
            th Ø§Ù„Ø§Ø³Ù…
            th Ø§Ù„ÙØ¦Ø©
            th Ø§Ù„Ø³Ø¹Ø±
            th Ø§Ù„ÙˆØµÙ
            th Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
        tbody
          if meals && meals.length > 0
            - var limitedMeals = meals.slice(0, 10)
            each meal in limitedMeals
              tr(data-meal=JSON.stringify(meal))
                td
                  if meal.image
                    img.product-thumbnail(src=meal.image alt=meal.name)
                  else
                    .no-image Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©
                td #{meal.name}
                td #{meal.category}
                td #{meal.price} Ø¬Ù†ÙŠÙ‡
                td.description-cell #{meal.description ? meal.description.substring(0, 50) + '...' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}
                td.actions-cell
                  button.btn-edit(data-id=meal._id data-action="editMeal") ØªØ¹Ø¯ÙŠÙ„
                  button.btn-delete(data-id=meal._id data-action="deleteMeal") Ø­Ø°Ù
          else
            tr
              td(colspan="6").no-data Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹

      if meals && meals.length > 10
        .view-more
          a.btn-secondary(href="/admin/meals") Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (#{meals.length})

    // ===== Offers Section =====
    .dashboard-section
      .section-header
        h3 ğŸ Ø§Ù„Ø¹Ø±ÙˆØ¶
        button.btn-primary(onclick="openAddOfferModal()") + Ø¥Ø¶Ø§ÙØ© Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯

      table.products-table
        thead
          tr
            th Ø§Ù„ØµÙˆØ±Ø©
            th Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
            th Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…
            th Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
            th Ø§Ù„ÙˆØµÙ
            th Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
        tbody
          if offers && offers.length > 0
            - var limitedOffers = offers.slice(0, 10)
            each offer in limitedOffers
              tr(data-offer=JSON.stringify(offer))
                td
                  if offer.image
                    img.product-thumbnail(src=offer.image alt=offer.title)
                  else
                    .no-image Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©
                td #{offer.name}
                td
                  if offer.price
                    span.old-price #{offer.price} Ø¬Ù†ÙŠÙ‡
                  else
                    | -
                td
                  if offer.newprice
                    span.new-price #{offer.newprice} Ø¬Ù†ÙŠÙ‡
                  else
                    | -
                td.description-cell #{offer.description ? offer.description.substring(0, 50) + '...' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}
                td.actions-cell
                  button.btn-edit(data-id=offer._id data-action="editOffer") ØªØ¹Ø¯ÙŠÙ„
                  button.btn-delete(data-id=offer._id data-action="deleteOffer") Ø­Ø°Ù
          else
            tr
              td(colspan="6").no-data Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø±ÙˆØ¶ Ø­Ø§Ù„ÙŠØ§Ù‹

      if offers && offers.length > 10
        .view-more
          a.btn-secondary(href="/admin/offers") Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ø±ÙˆØ¶ (#{offers.length})

  // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ Modals Ø²ÙŠ Ù…Ø§ Ù‡Ù…...
  #addMealModal.modal
    .modal-content
      .modal-header
        h3 Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
        span.close(onclick="closeModal('addMealModal')") Ã—
      form#addMealForm(onsubmit="addMeal(event)")
        .form-group
          label(for="addMealName") Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬
          input#addMealName(type="text" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬")

        .form-group
          label(for="addMealCategory") Ø§Ù„ØµÙ†Ù
          input#addMealCategory(type="text" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù (Ù…Ø«Ø§Ù„: Ù…Ø´Ø§ÙˆÙŠØŒ Ù…Ø­Ø§Ø´ÙŠØŒ Ø¥Ù„Ø®)")

        .form-group
          label(for="addMealPrice") Ø§Ù„Ø³Ø¹Ø±
          input#addMealPrice(type="number" step="0.01" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø±")

        .form-group
          label(for="addMealDescription") Ø§Ù„ÙˆØµÙ
          textarea#addMealDescription(rows="3" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)")

        .form-group
          label(for="addMealImage") Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
          input#addMealImage(type="url" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" oninput="updateImagePreview('addMealImage', 'addMealImagePreview')")
          img#addMealImagePreview.image-preview(style="display:none")

        .form-actions
          button.btn-primary(type="submit") Ø¥Ø¶Ø§ÙØ©
          button.btn-secondary(type="button" onclick="closeModal('addMealModal')") Ø¥Ù„ØºØ§Ø¡

  #editMealModal.modal
    .modal-content
      .modal-header
        h3 ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬
        span.close(onclick="closeModal('editMealModal')") Ã—
      form#editMealForm(onsubmit="updateMeal(event)")
        input#editMealId(type="hidden")

        .form-group
          label(for="editMealName") Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬
          input#editMealName(type="text" required)

        .form-group
          label(for="editMealCategory") Ø§Ù„ÙØ¦Ø©
          input#editMealCategory(type="text" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø©")

        .form-group
          label(for="editMealPrice") Ø§Ù„Ø³Ø¹Ø±
          input#editMealPrice(type="number" step="0.01" required)

        .form-group
          label(for="editMealDescription") Ø§Ù„ÙˆØµÙ
          textarea#editMealDescription(rows="3")

        .form-group
          label(for="editMealImage") Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
          input#editMealImage(type="url" oninput="updateImagePreview('editMealImage', 'editMealImagePreview')")
          img#editMealImagePreview.image-preview

        .form-actions
          button.btn-primary(type="submit") Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
          button.btn-secondary(type="button" onclick="closeModal('editMealModal')") Ø¥Ù„ØºØ§Ø¡

  #addOfferModal.modal
    .modal-content
      .modal-header
        h3 Ø¥Ø¶Ø§ÙØ© Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯
        span.close(onclick="closeModal('addOfferModal')") Ã—
      form#addOfferForm(onsubmit="addOffer(event)")
        .form-group
          label(for="addOfferTitle") Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶
          input#addOfferTitle(type="text" required placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶")

        .form-group
          label(for="addOfferPrice") Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…
          input#addOfferPrice(type="number" step="0.01" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…")

        .form-group
          label(for="addOfferNewPrice") Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…)
          input#addOfferNewPrice(type="number" step="0.01" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)")

        .form-group
          label(for="addOfferDescription") Ø§Ù„ÙˆØµÙ
          textarea#addOfferDescription(rows="3" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)")

        .form-group
          label(for="addOfferImage") Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
          input#addOfferImage(type="url" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" oninput="updateImagePreview('addOfferImage', 'addOfferImagePreview')")
          img#addOfferImagePreview.image-preview(style="display:none")

        .form-actions
          button.btn-primary(type="submit") Ø¥Ø¶Ø§ÙØ©
          button.btn-secondary(type="button" onclick="closeModal('addOfferModal')") Ø¥Ù„ØºØ§Ø¡

  #editOfferModal.modal
    .modal-content
      .modal-header
        h3 ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶
        span.close(onclick="closeModal('editOfferModal')") Ã—
      form#editOfferForm(onsubmit="updateOffer(event)")
        input#editOfferId(type="hidden")

        .form-group
          label(for="editOfferTitle") Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶
          input#editOfferTitle(type="text" required)

        .form-group
          label(for="editOfferPrice") Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…
          input#editOfferPrice(type="number" step="0.01" required)

        .form-group
          label(for="editOfferNewPrice") Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…)
          input#editOfferNewPrice(type="number" step="0.01")

        .form-group
          label(for="editOfferDescription") Ø§Ù„ÙˆØµÙ
          textarea#editOfferDescription(rows="3")

        .form-group
          label(for="editOfferImage") Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
          input#editOfferImage(type="url" oninput="updateImagePreview('editOfferImage', 'editOfferImagePreview')")
          img#editOfferImagePreview.image-preview

        .form-actions
          button.btn-primary(type="submit") Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
          button.btn-secondary(type="button" onclick="closeModal('editOfferModal')") Ø¥Ù„ØºØ§Ø¡

  #orderInvoiceModal.modal
    .modal-content.invoice-modal
      .modal-header
        h3 ğŸ“„ ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø·Ù„Ø¨
        .invoice-actions
          button.btn-print(onclick="printInvoice()") ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©
          span.close(onclick="closeModal('orderInvoiceModal')") Ã—

      #invoiceContent.invoice-content

  script(src="/js/admin.js")
